
# A Framework for Neural Topic Modeling using Hierarchical Clustering and Contrastive Learning with Optimal Transport

## Setup

1. Install the required libraries:
    ```bash
    pip install -r requirements.txt
    ```

2. Install Java.

3. Download [this Java JAR file](https://hobbitdata.informatik.uni-leipzig.de/homes/mroeder/palmetto/palmetto-0.1.0-jar-with-dependencies.jar) and place it in `./evaluations/palmetto.jar`.

4. Download and extract [this processed Wikipedia corpus](https://hobbitdata.informatik.uni-leipzig.de/homes/mroeder/palmetto/Wikipedia_bd.zip) to `./datasets/wikipedia/`, which will serve as an external reference corpus.

## Dataset Structure

- The dataset folder is located in the `datasets` directory.
- Document embeddings generated by **Doc2Vec** can be found in `datasets/<dataset_name>/doc2vec`.
- Document embeddings generated by **SBERT** are located in `datasets/<dataset_name>/with_bert`.

## Usage

- To run **ETM + HiCOT**, set `model_name = "ETM_Plus"`.
- To run **ECRTM + HiCOT**, set `model_name = "ECRTM_Plus"`.
- To run **CTM + HiCOT**, set `model_name = "CombinedTM_Plus"`.
- To run **FASTopic + HiCOT**, set `model_name = "FASTopic_Plus"`.
- To run **NeuroMax + HiCOT**, set `model_name = "NeuroMax_Plus"`.

## Options

- **Datasets**: Available datasets include `20NG`, `AGNews`, and `IMDB`.
  
- **Hierarchical Clustering Algorithms**:  
  - Set `method_CL` to one of the following:
    - `HAC` (Hierarchical Agglomerative Clustering)
    - `HDBSCAN` (Hierarchical Density-Based Spatial Clustering of Applications with Noise)

- **Distance Metrics for Contrastive Learning**:  
  - Set `metric_CL` to one of the following:
    - `euclidean`
    - `cosine`

- **Sampling Strategy for Contrastive Learning**:  
  - Set `positive_sampling` to `random` (default), or `hard` for hard negative sampling.
  - Set `negative_sampling` to `random` (default), or `hard` for hard negative sampling.

- **Contrastive Loss Function**:  
  - Set `contrastive_loss_type` to one of the following types:
    - `triplet`
    - `circle`
    - `infonce`

## Acknowledgement

Some parts of this implementation are based on [TopMost](https://github.com/BobXWu/TopMost). We also utilize [Palmetto](https://github.com/dice-group/Palmetto) for evaluating topic coherence.
